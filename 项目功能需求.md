# Vibe zkTLS 项目功能需求文档

## 项目概述

Vibe zkTLS 是一个基于零知识传输层安全（zkTLS）技术的代币分发系统，部署在 Monad 测试网上。该项目通过隐私保护的身份验证机制，为用户提供安全的社交媒体账户验证和代币奖励系统。

## 核心功能需求

### 1. 用户身份验证系统

#### 1.1 钱包连接功能
- **功能描述**: 用户通过 MetaMask 钱包连接到应用
- **技术要求**: 
  - 支持 MetaMask 钱包连接
  - 自动检测钱包安装状态
  - 获取用户以太坊地址
  - 支持网络切换到 Monad 测试网
- **用户流程**: 
  1. 用户点击"连接钱包"按钮
  2. 系统检测 MetaMask 是否安装
  3. 请求用户授权连接
  4. 获取用户地址并显示连接状态

#### 1.2 zkTLS 身份验证
- **功能描述**: 使用 Primus SDK 进行 Twitter 账户的零知识验证
- **技术要求**:
  - 集成 Primus zkTLS SDK v0.3.3
  - 生成 Twitter 账户的零知识证明
  - 保护用户隐私数据
  - 返回可验证的证明数据
- **验证流程**:
  1. 用户点击"验证 Twitter 账户"
  2. 系统调用 Primus SDK
  3. 用户在弹窗中登录 Twitter
  4. 生成 zkTLS 证明
  5. 返回证明哈希和数据

#### 1.3 防重复验证机制
- **功能描述**: 防止同一 Twitter 账户被多个钱包地址使用
- **技术要求**:
  - 记录已使用的 Twitter 用户名
  - 检查钱包地址是否已验证
  - 提供清晰的错误提示
- **验证规则**:
  - 每个钱包地址只能验证一次
  - 每个 Twitter 账户只能被一个钱包使用

### 2. 代币分发系统

#### 2.1 VIBE 代币申领
- **功能描述**: 验证通过的用户可申领 100 个 VIBE 代币
- **技术要求**:
  - ERC20 代币标准实现
  - 智能合约自动分发
  - 防重复申领机制
  - 交易状态跟踪
- **申领流程**:
  1. 用户完成 Twitter 验证
  2. 点击"申领代币"按钮
  3. 智能合约验证 zkTLS 证明
  4. 自动转账 100 VIBE 到用户钱包

#### 2.2 智能合约验证
- **功能描述**: 链上验证 zkTLS 证明的有效性
- **技术要求**:
  - 集成 Primus 验证合约
  - 验证证明签名和数据
  - 检查证明时效性
  - 提取 Twitter 用户名信息
- **验证逻辑**:
  - 调用 Primus 合约验证证明
  - 检查证明接收者是否为调用者
  - 验证 Twitter 用户名格式
  - 确保用户名未被使用

### 3. 创作者平台功能

#### 3.1 创作者注册系统
- **功能描述**: 支持内容创作者注册和等级管理
- **技术要求**:
  - 多平台身份验证支持
  - 信誉分数计算系统
  - 创作者等级划分
  - 权限管理机制
- **等级系统**:
  - Level 1: 新手创作者 (0-100分)
  - Level 2: 进阶创作者 (100-500分)
  - Level 3: 专业创作者 (500-1500分)
  - Level 4: 影响力创作者 (1500-5000分)
  - Level 5: 顶级创作者 (5000+分)

#### 3.2 个人代币创建
- **功能描述**: 高等级创作者可创建个人 ERC20 代币
- **技术要求**:
  - 代币工厂合约实现
  - 权限检查机制
  - 代币参数配置
  - 创建费用管理
- **创建条件**:
  - 创作者等级达到 Level 3 或以上
  - 完成多平台身份验证
  - 支付创建费用

#### 3.3 内容管理系统
- **功能描述**: 创作者可发布内容并跟踪表现数据
- **技术要求**:
  - IPFS 内容存储
  - 内容哈希生成
  - 互动数据记录
  - 奖励计算逻辑
- **内容数据**:
  - 内容标题和描述
  - IPFS 哈希值
  - 发布平台信息
  - 浏览量、点赞数、分享数

### 4. 奖励分发系统

#### 4.1 奖励池管理
- **功能描述**: 创作者可为自己的内容设置奖励池
- **技术要求**:
  - 代币质押机制
  - 奖励池余额管理
  - 基础奖励计算
  - 分发时间控制
- **管理功能**:
  - 注资奖励池
  - 设置基础奖励
  - 查看池余额
  - 奖励历史记录

#### 4.2 自动奖励分发
- **功能描述**: 基于内容表现自动计算和分发奖励
- **技术要求**:
  - 互动数据权重计算
  - 创作者等级加成
  - 时间窗口控制
  - 最小奖励阈值
- **计算公式**:
  - 基础分数 = 浏览量 + 点赞数×10 + 分享数×50
  - 等级加成 = 创作者等级 × 20%
  - 最终奖励 = 基础奖励 × 倍数 × (1 + 等级加成)

### 5. 用户界面需求

#### 5.1 主页设计
- **功能描述**: 清晰展示平台功能和使用流程
- **设计要求**:
  - 响应式布局设计
  - 现代化 UI 风格
  - 功能介绍卡片
  - 操作流程指引
- **页面元素**:
  - 平台标题和介绍
  - 三大核心功能展示
  - 钱包连接按钮
  - 验证和申领流程

#### 5.2 验证界面
- **功能描述**: 用户友好的身份验证界面
- **设计要求**:
  - 清晰的操作指引
  - 实时状态反馈
  - 错误信息提示
  - 成功确认展示
- **交互元素**:
  - 验证按钮和加载状态
  - 进度指示器
  - 错误和成功提示
  - 重试和重置选项

#### 5.3 创作者仪表板
- **功能描述**: 创作者专用的管理界面
- **设计要求**:
  - 数据可视化展示
  - 功能模块划分
  - 权限状态显示
  - 操作快捷入口
- **仪表板模块**:
  - 个人信息和等级
  - 已验证平台状态
  - 内容统计数据
  - 奖励收益信息

### 6. 技术架构需求

#### 6.1 前端技术栈
- **框架**: Next.js 14 + TypeScript
- **UI 库**: Shadcn/ui + Tailwind CSS
- **图标**: Lucide React
- **Web3**: Ethers.js v6
- **状态管理**: React Hooks + Context

#### 6.2 智能合约技术栈
- **开发框架**: Foundry
- **编程语言**: Solidity ^0.8.20
- **测试框架**: Forge
- **部署工具**: Forge Script

#### 6.3 区块链集成
- **主网络**: Monad 测试网
- **链 ID**: 10143
- **RPC**: https://testnet-rpc.monad.xyz
- **浏览器**: https://testnet.monadexplorer.com

### 7. 安全性需求

#### 7.1 智能合约安全
- **访问控制**: 基于角色的权限管理
- **重入攻击防护**: 使用 ReentrancyGuard
- **整数溢出防护**: Solidity 0.8+ 内置检查
- **输入验证**: 严格的参数检查

#### 7.2 前端安全
- **输入验证**: 客户端数据清理
- **XSS 防护**: 内容转义处理
- **敏感数据**: 环境变量管理
- **错误处理**: 安全的错误信息展示

#### 7.3 隐私保护
- **零知识证明**: zkTLS 技术保护用户隐私
- **最小化数据**: 只存储必要的公开信息
- **数据加密**: 敏感信息加密存储

### 8. 性能需求

#### 8.1 前端性能
- **页面加载**: 首屏加载时间 < 3秒
- **交互响应**: 用户操作响应 < 500ms
- **代码分割**: 按需加载优化
- **缓存策略**: 静态资源缓存

#### 8.2 智能合约性能
- **Gas 优化**: 合约调用成本最小化
- **批量操作**: 支持批量处理减少交易次数
- **状态管理**: 高效的存储结构设计

### 9. 测试需求

#### 9.1 智能合约测试
- **单元测试**: 每个函数的独立测试
- **集成测试**: 合约间交互测试
- **安全测试**: 攻击场景模拟
- **Gas 测试**: 成本优化验证

#### 9.2 前端测试
- **组件测试**: React 组件单元测试
- **集成测试**: 用户流程测试
- **E2E 测试**: 端到端场景测试
- **兼容性测试**: 多浏览器支持

### 10. 部署和运维需求

#### 10.1 开发环境
- **本地开发**: Anvil 本地区块链
- **热重载**: 开发时自动更新
- **调试工具**: 完整的调试支持

#### 10.2 测试环境
- **测试网部署**: Monad 测试网
- **CI/CD**: 自动化构建和部署
- **环境隔离**: 开发和生产环境分离

#### 10.3 生产环境
- **高可用性**: 服务稳定性保证
- **监控告警**: 系统状态监控
- **备份恢复**: 数据安全保障

## 验收标准

### 功能验收
- [ ] 用户可以成功连接 MetaMask 钱包
- [ ] 用户可以通过 zkTLS 验证 Twitter 账户
- [ ] 验证成功后可以申领 100 VIBE 代币
- [ ] 防止重复验证和申领
- [ ] 创作者可以注册和升级等级
- [ ] 高等级创作者可以创建个人代币
- [ ] 内容发布和奖励分发正常工作

### 技术验收
- [ ] 智能合约通过安全审计
- [ ] 前端界面响应式设计完整
- [ ] 所有功能有完整的错误处理
- [ ] 测试覆盖率达到 90% 以上
- [ ] 性能指标满足要求

### 用户体验验收
- [ ] 界面直观易用
- [ ] 操作流程清晰
- [ ] 错误提示友好
- [ ] 加载状态明确
- [ ] 成功反馈及时

## 项目里程碑

### 阶段一：基础功能 (2-3周)
- 智能合约开发和测试
- 基础前端界面
- 钱包连接和 zkTLS 验证
- 代币申领功能

### 阶段二：创作者功能 (2-3周)
- 创作者注册系统
- 多平台身份验证
- 个人代币创建
- 创作者仪表板

### 阶段三：奖励系统 (2-3周)
- 内容管理功能
- 奖励池管理
- 自动奖励分发
- 数据统计展示

### 阶段四：优化和部署 (1-2周)
- 性能优化
- 安全加固
- 测试完善
- 生产部署

## 风险评估

### 技术风险
- **zkTLS 集成复杂性**: 需要深入理解 Primus SDK
- **智能合约安全**: 需要专业的安全审计
- **跨链兼容性**: Monad 测试网的特殊性

### 业务风险
- **用户接受度**: 新技术的用户教育成本
- **监管合规**: 代币分发的法律风险
- **竞争压力**: 类似项目的市场竞争

### 缓解措施
- 充分的技术调研和测试
- 专业的安全审计和代码审查
- 完善的用户文档和教程
- 合规性法律咨询